

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>estimator &mdash; QuaternionUkf 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="estimator.data" href="estimator.data.html" />
    <link rel="prev" title="estimator" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> QuaternionUkf
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="includeme.html">Quaternion-Based UKF for Orientation Tracking</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">estimator</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">estimator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="estimator.data.html">estimator.data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-estimator.constants">estimator.constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-estimator.quaternions">estimator.quaternions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-estimator.quaternionukf">estimator.quaternionukf</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#quaternion-ukf">Quaternion UKF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-estimator.roll_pitch_calculator">estimator.roll_pitch_calculator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-estimator.state_estimator">estimator.state_estimator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-estimator.velocity_integrator">estimator.velocity_integrator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-estimator">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">QuaternionUkf</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">estimator</a> &raquo;</li>
        
      <li>estimator</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/estimator.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="estimator">
<h1>estimator<a class="headerlink" href="#estimator" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="estimator.data.html">estimator.data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="estimator.data.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimator.data.html#module-estimator.data.datamaker">estimator.data.datamaker</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimator.data.html#module-estimator.data.datasource">estimator.data.datasource</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimator.data.html#module-estimator.data.datastore">estimator.data.datastore</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimator.data.html#module-estimator.data.trainer">estimator.data.trainer</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimator.data.html#module-estimator.data.trajectoryplanner">estimator.data.trajectoryplanner</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimator.data.html#module-estimator.data.utilities">estimator.data.utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="estimator.data.html#module-estimator.data">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-estimator.constants">
<span id="estimator-constants"></span><h2>estimator.constants<a class="headerlink" href="#module-estimator.constants" title="Permalink to this headline">¶</a></h2>
<p>Constants associated with the various classes in this project</p>
</div>
<div class="section" id="module-estimator.quaternions">
<span id="estimator-quaternions"></span><h2>estimator.quaternions<a class="headerlink" href="#module-estimator.quaternions" title="Permalink to this headline">¶</a></h2>
<p>Quaternions wraps numpy arrays to make operations on arrays of quaternions easier.
Because the quaternion UKF has 15 sigma points to project forward and because we
want to take advantage of numpy broadcasting, the array wrapped by Quaternions is
of shape (4, N) where N &gt;= 0.</p>
<p>So, Quaternions can either represent a single quaternion or multiple, and operations
are allowed between two Quaternions objects when:</p>
<ul class="simple">
<li><p>Their array shapes match, so all operations are one-to-one</p></li>
<li><p>One is a single quaternion and the other is not, so all operations are one-to-many</p></li>
</ul>
<p>For example all of the following are allowed:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">estimator.quaternions</span> <span class="k">import</span> <span class="n">Quaternions</span>

<span class="n">single</span> <span class="o">=</span> <span class="n">Quaternions</span><span class="o">.</span><span class="n">from_vectors</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">multiple</span> <span class="o">=</span> <span class="n">Quaternions</span><span class="o">.</span><span class="n">from_vectors</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>

<span class="c1"># All of the below are allowed</span>
<span class="nb">print</span><span class="p">(</span><span class="n">single</span><span class="o">.</span><span class="n">q_multiply</span><span class="p">(</span><span class="n">single</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">single</span><span class="o">.</span><span class="n">q_multiply</span><span class="p">(</span><span class="n">multiple</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multiple</span><span class="o">.</span><span class="n">q_multiply</span><span class="p">(</span><span class="n">single</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">multiple</span><span class="o">.</span><span class="n">q_multiply</span><span class="p">(</span><span class="n">multiple</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<dl class="py class">
<dt id="estimator.quaternions.Quaternions">
<em class="property">class </em><code class="sig-name descname">Quaternions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">array</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternions.html#Quaternions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternions.Quaternions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Wrapper for numpy arrays for quaternion math</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#estimator.quaternions.Quaternions.NDIM" title="estimator.quaternions.Quaternions.NDIM"><strong>NDIM</strong></a> – size of dimension 0 of the wrapped array</p></li>
<li><p><a class="reference internal" href="#estimator.quaternions.Quaternions.EPSILON" title="estimator.quaternions.Quaternions.EPSILON"><strong>EPSILON</strong></a> – tolerance for finding the mean of multiple quaternions</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="estimator.quaternions.Quaternions.EPSILON">
<code class="sig-name descname">EPSILON</code><em class="property"> = 1e-05</em><a class="headerlink" href="#estimator.quaternions.Quaternions.EPSILON" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="estimator.quaternions.Quaternions.NDIM">
<code class="sig-name descname">NDIM</code><em class="property"> = 4</em><a class="headerlink" href="#estimator.quaternions.Quaternions.NDIM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.array">
<em class="property">property </em><code class="sig-name descname">array</code><a class="headerlink" href="#estimator.quaternions.Quaternions.array" title="Permalink to this definition">¶</a></dt>
<dd><p>Getter for wrapped array</p>
</dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.find_q_mean">
<code class="sig-name descname">find_q_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q_mean</span></em>, <em class="sig-param"><span class="n">iterations</span><span class="o">=</span><span class="default_value">1000</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternions.html#Quaternions.find_q_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternions.Quaternions.find_q_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the mean of a quaternion or array of quaternions using gradient descent</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iterations</strong> – max number of iterations</p></li>
<li><p><strong>q_mean</strong> – initial mean guess</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>final mean</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.from_list">
<em class="property">classmethod </em><code class="sig-name descname">from_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">quat_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternions.html#Quaternions.from_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternions.Quaternions.from_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs quaternions from list of 4-element lists of numbers</p>
</dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.from_quaternions">
<em class="property">classmethod </em><code class="sig-name descname">from_quaternions</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">qs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternions.html#Quaternions.from_quaternions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternions.Quaternions.from_quaternions" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs quaternions from list of singleton quaternion arrays</p>
</dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.from_vectors">
<em class="property">static </em><code class="sig-name descname">from_vectors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vectors</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternions.html#Quaternions.from_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternions.Quaternions.from_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts vector or array of vectors to an array of quaternions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vectors</strong> – vector to convert</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>resulting quaternion(s)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.inverse">
<code class="sig-name descname">inverse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternions.html#Quaternions.inverse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternions.Quaternions.inverse" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the inverse of a quaternion or array of quaternions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.length">
<em class="property">property </em><code class="sig-name descname">length</code><a class="headerlink" href="#estimator.quaternions.Quaternions.length" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of quaternions in this Quaternions object</p>
</dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.q_multiply">
<code class="sig-name descname">q_multiply</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">that</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternions.html#Quaternions.q_multiply"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternions.Quaternions.q_multiply" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiplies two quaternions (or arrays of quaternions) together taking advantage of
numpy broadcasting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>that</strong> – quaternion to multiply with</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>resulting quaternion or array of quaternions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.rotate_vector">
<code class="sig-name descname">rotate_vector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vector</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternions.html#Quaternions.rotate_vector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternions.Quaternions.rotate_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates a vector with this array of n quaternions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vector</strong> – (3,) numpy array to rotate</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(3, n) matrix of vectors if n &gt; 1, otherwise a (3,) vector</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.to_rotation_matrix">
<code class="sig-name descname">to_rotation_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternions.html#Quaternions.to_rotation_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternions.Quaternions.to_rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts quaternion or array of quaternions to a rotation matrix or matrices</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>rotation matrix or matrices as numpy arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.to_vectors">
<code class="sig-name descname">to_vectors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternions.html#Quaternions.to_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternions.Quaternions.to_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a quaternion or array of quaternions to a vector or array of vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>vector(s) as a numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="estimator.quaternions.Quaternions.with_positive_scalar">
<code class="sig-name descname">with_positive_scalar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternions.html#Quaternions.with_positive_scalar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternions.Quaternions.with_positive_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes the sign of the scalar component positive while representing the same rotation</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-estimator.quaternionukf">
<span id="estimator-quaternionukf"></span><h2>estimator.quaternionukf<a class="headerlink" href="#module-estimator.quaternionukf" title="Permalink to this headline">¶</a></h2>
<div class="section" id="quaternion-ukf">
<h3>Quaternion UKF<a class="headerlink" href="#quaternion-ukf" title="Permalink to this headline">¶</a></h3>
<p>This implementation of a UKF for tracking orientation of a drone with gyro and accelerometer
data follows closely that described in the paper “A Quaternion-based Unscented Kalman Filter for
Orientation Tracking” by Edgar Kraft.</p>
<p>This project was completed as part of ESE 650: Learning in Robotics at the University of
Pennsylvania, though it has been tweaked, and additional infrastructure has been built since then.</p>
<p>My initial version was highly sensitive to my process model noise, which I tuned to the thousandth
decimal place to be able to pass all tests. That’s indicative that version was flawed.</p>
<p>The updated version has fixed the instabilities that existed at pi and -pi, and it’s no longer
so sensitive to how I choose to model the process noise. The process and noise models still can
be improved with techniques like simulated annealing, but that’s for another time…</p>
<p>Here’s an example of how this can be used with some toy data generated by the some of the
new infrastructure I’ve built to test this new implementation:</p>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">estimator.constants</span> <span class="k">import</span> <span class="n">STATE_DOF</span>

<span class="c1"># Set measurement and process model noise to something reasonable</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">STATE_DOF</span><span class="p">)</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span>
<span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>

<span class="c1"># Build some toy data with rudimentary model of noise and drift in the sensor data</span>
<span class="n">planner</span> <span class="o">=</span> <span class="n">RoundTripPlanner</span><span class="p">()</span>
<span class="n">data_source</span> <span class="o">=</span> <span class="n">DataMaker</span><span class="p">(</span><span class="n">planner</span><span class="p">)</span>

<span class="c1"># Filter the data and plot the comparison</span>
<span class="n">estimator</span> <span class="o">=</span> <span class="n">QuaternionUkf</span><span class="p">(</span><span class="n">data_source</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">estimate_state</span><span class="p">()</span>
<span class="n">estimator</span><span class="o">.</span><span class="n">plot_comparison</span><span class="p">(</span>
    <span class="n">estimator</span><span class="o">.</span><span class="n">rots</span><span class="p">,</span>
    <span class="n">estimator</span><span class="o">.</span><span class="n">ts_imu</span><span class="p">,</span>
    <span class="n">data_source</span><span class="o">.</span><span class="n">rots_vicon</span><span class="p">,</span>
    <span class="n">data_source</span><span class="o">.</span><span class="n">ts_vicon</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<dl class="py class">
<dt id="estimator.quaternionukf.QuaternionUkf">
<em class="property">class </em><code class="sig-name descname">QuaternionUkf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source</span></em>, <em class="sig-param"><span class="n">measurement_noise</span></em>, <em class="sig-param"><span class="n">process_noise</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternionukf.html#QuaternionUkf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternionukf.QuaternionUkf" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#estimator.state_estimator.StateEstimator" title="estimator.state_estimator.StateEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">estimator.state_estimator.StateEstimator</span></code></a></p>
<p>Estimates rotational position/velocity state of robot from time series data</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference internal" href="#estimator.quaternionukf.QuaternionUkf.G_VECTOR" title="estimator.quaternionukf.QuaternionUkf.G_VECTOR"><strong>G_VECTOR</strong></a> – normalized 3D gravity vector</p></li>
<li><p><strong>measurement_noise</strong> – estimated noise in a given sensor measurement</p></li>
<li><p><strong>process_noise</strong> – estimated noise involved in a given step of the process model</p></li>
<li><p><strong>state</strong> – (7, <a class="reference internal" href="#estimator.state_estimator.StateEstimator.num_data" title="estimator.state_estimator.StateEstimator.num_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">num_data()</span></code></a>)
numpy array of state vectors the first 4 elements of which are a
quaternion and the latter three an angular velocity vector</p></li>
<li><p><strong>covariance</strong> – (6, 6, <a class="reference internal" href="#estimator.state_estimator.StateEstimator.num_data" title="estimator.state_estimator.StateEstimator.num_data"><code class="xref py py-meth docutils literal notranslate"><span class="pre">num_data()</span></code></a>)
numpy array of the estimated covariance of each degree of freedom in
the state</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="estimator.quaternionukf.QuaternionUkf.G_VECTOR">
<code class="sig-name descname">G_VECTOR</code><em class="property"> = array([0, 0, 1])</em><a class="headerlink" href="#estimator.quaternionukf.QuaternionUkf.G_VECTOR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="estimator.quaternionukf.QuaternionUkf.estimate_state">
<code class="sig-name descname">estimate_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/quaternionukf.html#QuaternionUkf.estimate_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.quaternionukf.QuaternionUkf.estimate_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses data provided by the source to estimate the state history of the filter
After calling this function, the state and rotation history will be defined</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-estimator.roll_pitch_calculator">
<span id="estimator-roll-pitch-calculator"></span><h2>estimator.roll_pitch_calculator<a class="headerlink" href="#module-estimator.roll_pitch_calculator" title="Permalink to this headline">¶</a></h2>
<p>Estimates roll and pitch based on accelerometer data, which are the only angles
that can be calculated from only the accelerometer.</p>
<dl class="py class">
<dt id="estimator.roll_pitch_calculator.RollPitchCalculator">
<em class="property">class </em><code class="sig-name descname">RollPitchCalculator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/roll_pitch_calculator.html#RollPitchCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.roll_pitch_calculator.RollPitchCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#estimator.state_estimator.StateEstimator" title="estimator.state_estimator.StateEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">estimator.state_estimator.StateEstimator</span></code></a></p>
<p>Simplest implementation of an estimator - no integration,
just directly calculates roll and pitch at each timestep</p>
<dl class="py method">
<dt id="estimator.roll_pitch_calculator.RollPitchCalculator.estimate_state">
<code class="sig-name descname">estimate_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/roll_pitch_calculator.html#RollPitchCalculator.estimate_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.roll_pitch_calculator.RollPitchCalculator.estimate_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses data provided by the source to estimate the state history of the filter
After calling this function, the state and rotation history will be defined</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-estimator.state_estimator">
<span id="estimator-state-estimator"></span><h2>estimator.state_estimator<a class="headerlink" href="#module-estimator.state_estimator" title="Permalink to this headline">¶</a></h2>
<p>Defines interface for classes which estimate the state of an object equipped with an IMU.
This state is meant to capture the orientation of, for example, a drone.</p>
<dl class="py class">
<dt id="estimator.state_estimator.StateEstimator">
<em class="property">class </em><code class="sig-name descname">StateEstimator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/state_estimator.html#StateEstimator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.state_estimator.StateEstimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Parent class for both the UKF and the NoFilter implementation</p>
<dl class="py method">
<dt id="estimator.state_estimator.StateEstimator.acc_data">
<code class="sig-name descname">acc_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/state_estimator.html#StateEstimator.acc_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.state_estimator.StateEstimator.acc_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Acceleromter data</p>
</dd></dl>

<dl class="py method">
<dt id="estimator.state_estimator.StateEstimator.estimate_state">
<em class="property">abstract </em><code class="sig-name descname">estimate_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/state_estimator.html#StateEstimator.estimate_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.state_estimator.StateEstimator.estimate_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses data provided by the source to estimate the state history of the filter
After calling this function, the state and rotation history will be defined</p>
</dd></dl>

<dl class="py method">
<dt id="estimator.state_estimator.StateEstimator.evaluate_estimation">
<code class="sig-name descname">evaluate_estimation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/state_estimator.html#StateEstimator.evaluate_estimation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.state_estimator.StateEstimator.evaluate_estimation" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes 3 plots for roll, pitch, and yaw comparisons of estimated versus truth data</p>
</dd></dl>

<dl class="py method">
<dt id="estimator.state_estimator.StateEstimator.imu_data">
<code class="sig-name descname">imu_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/state_estimator.html#StateEstimator.imu_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.state_estimator.StateEstimator.imu_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Accelerometer and gyro data from imu</p>
</dd></dl>

<dl class="py method">
<dt id="estimator.state_estimator.StateEstimator.num_data">
<em class="property">property </em><code class="sig-name descname">num_data</code><a class="headerlink" href="#estimator.state_estimator.StateEstimator.num_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Length of imu data array</p>
</dd></dl>

<dl class="py method">
<dt id="estimator.state_estimator.StateEstimator.ts_imu">
<em class="property">property </em><code class="sig-name descname">ts_imu</code><a class="headerlink" href="#estimator.state_estimator.StateEstimator.ts_imu" title="Permalink to this definition">¶</a></dt>
<dd><p>Times associated with imu data</p>
</dd></dl>

<dl class="py method">
<dt id="estimator.state_estimator.StateEstimator.vel_data">
<em class="property">property </em><code class="sig-name descname">vel_data</code><a class="headerlink" href="#estimator.state_estimator.StateEstimator.vel_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Gyro data</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-estimator.velocity_integrator">
<span id="estimator-velocity-integrator"></span><h2>estimator.velocity_integrator<a class="headerlink" href="#module-estimator.velocity_integrator" title="Permalink to this headline">¶</a></h2>
<p>Integrates gyro data and keeps track of the orientation of the robot</p>
<dl class="py class">
<dt id="estimator.velocity_integrator.VelocityIntegrator">
<em class="property">class </em><code class="sig-name descname">VelocityIntegrator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">source</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/velocity_integrator.html#VelocityIntegrator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.velocity_integrator.VelocityIntegrator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#estimator.state_estimator.StateEstimator" title="estimator.state_estimator.StateEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">estimator.state_estimator.StateEstimator</span></code></a></p>
<p>Considers only gyro data to try to keep track of the orientation of the robot.
Gyro’s are generally quite accurate, but drift in the signal get’s integrated,
exacerbating the estimation error.</p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><p><strong>quats</strong> – list of quaternions with the same length as the number of timesteps</p>
</dd>
</dl>
<dl class="py method">
<dt id="estimator.velocity_integrator.VelocityIntegrator.estimate_state">
<code class="sig-name descname">estimate_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/estimator/velocity_integrator.html#VelocityIntegrator.estimate_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#estimator.velocity_integrator.VelocityIntegrator.estimate_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses data provided by the source to estimate the state history of the filter
After calling this function, the state and rotation history will be defined</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-estimator">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-estimator" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="estimator.data.html" class="btn btn-neutral float-right" title="estimator.data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="modules.html" class="btn btn-neutral float-left" title="estimator" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Matt Lisle

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>